<section>
    <div class="container g-3">
        <div class="row">
            <div class="col-12">
                <p class="topic-title h3 fw-bold mb-3">Thông tin cá nhân</p>
            </div>
            <div class="col-12">
                
            <form action="/user/profile?_method=PUT" method="POST" enctype="multipart/form-data">
                {{#with user}}
                <div class="row">
                    <div class="col-12 col-md-5">
                        <div class="profile-avatar text-center">
                            <img loading="lazy" src="{{avatar}}" id="imgAvatar" width="160px" height="160px" class="d-block m-auto rounded-circle mb-3">
                            <label for="fileAvatar" class="btn-label">Tải ảnh lên</label>
                            <input type="file" name="fileAvatar" id="fileAvatar" accept=".png, .jpeg, .jpg, .sgv, .gif" hidden>
                            <input type="text" name="avatar" id="avatar" hidden>
                        </div>
                        <div class="avatar-system justify-content-center d-flex align-items-center flex-wrap">
                            <img loading="lazy" src="/img/user1.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user2.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user3.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user4.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user5.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user6.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                            <img loading="lazy" src="/img/user7.jpg" width="80px" height="80px" class="rounded-circle mb-2" role="button" alt="">
                        </div>
                    </div>
                    
                    <div class="col-12 col-md-4">
                        <div class="profile-edit">
                            <div class="form-group mb-3">
                                <label class="mb-2" for="">Nickname<span class="text-danger">*</span></label>
                                <input type="text" class="form-control" name="username" id="username" value="{{username}}">
                            </div>
                            <div class="form-group d-flex mb-3">
                                <div class="group me-2 flex-fill">
                                    <label for="">Họ</label>
                                    <input type="text" class="form-control" name="firstName" id="firstName" value="{{firstName}}">
                                </div>
                                <div class="group ms-2 flex-fill">
                                    <label for="">Tên</label>
                                    <input type="text" class="form-control" name="lastName" id="lastName" value="{{lastName}}">
                                </div>
                            </div>
                            <div class="form-group mb-3">
                                <label class="mb-2" for="">Email<span class="text-danger">*</span></label>
                                <input type="text" class="form-control" name="email" id="email" value="{{email}}" readonly>
                            </div>
                            <div class="form-group mb-3">
                                <label class="mb-2" for="">Địa chỉ</label>
                                <input type="text" class="form-control" name="address" id="address" value="{{address}}">
                            </div>
                        </div>
                        <div class="form-button text-end">
                            <a href="/" class="me-4 h6">Hủy</a>
                            <button type="submit">Lưu thay đổi</button>
                        </div>
                    </div>
                </div>
                {{/with}}
            </form>
            </div>
        </div>
    </div>
</section>
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const imgSystem = document.querySelectorAll('.avatar-system img')
        const imgAvatar = document.querySelector('#imgAvatar')
        const avatar = document.querySelector('#avatar')
        const fileAvatar = document.querySelector('#fileAvatar')

        const page = {
            loadImgSystem() {
                imgSystem.forEach(element => {
                    element.onclick = function() {
                        imgAvatar.src = element.getAttribute('src')
                        avatar.value = element.getAttribute('src')
                    }
                })
            },

            uploadImg() {
                fileAvatar.onchange = function() {
                    var file = fileAvatar.files[0]
                    var reader = new FileReader()
                    reader.onload = function(e) {
                        imgAvatar.setAttribute('src', e.target.result)
                    }
                    reader.readAsDataURL(file)
                }
            },

            start() {
                this.loadImgSystem()
                this.uploadImg()
            }
        }

        page.start()
        
    })
</script>